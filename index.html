<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUMBER GO BIG</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #222;
            color: white;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            border: 2px solid #444;
            background: #111;
        }
        .controls {
            margin-top: 20px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        button {
            padding: 12px 24px;
            margin: 6px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            min-width: 100px;
        }
        
        @media (max-width: 768px) {
            button {
                padding: 15px 30px;
                font-size: 16px;
                min-width: 120px;
            }
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        .combine-btn {
            background: #2196F3 !important;
        }
        .combine-btn.active {
            background: #4CAF50 !important;
        }
        button.disabled {
            background: #666 !important;
            cursor: not-allowed;
        }
        button.combine-btn {
            background: #666 !important;
        }
        button.combine-btn.enabled {
            background: #4CAF50 !important;
        }
        .hand {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        .number-card {
            width: 55px;
            height: 40px;
            background: #333;
            border: 3px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
        }
        
        @media (max-width: 768px) {
            .number-card {
                width: 45px;
                height: 35px;
                font-size: 14px;
            }
        }
        .number-card.selected {
            background: #4CAF50;
            border-color: #45a049 !important;
        }
        .number-card.common {
            border-color: #888; /* Grey for 1-3 */
        }
        .number-card.uncommon {
            border-color: #2196F3; /* Blue for 4-6 */
        }
        .number-card.rare {
            border-color: #9C27B0; /* Purple for 7-8 */
        }
        .number-card.legendary {
            border-color: #FF9800; /* Orange for 9 */
        }
        .number-card.negative {
            color: #ff4444; /* Red text for negative numbers */
        }
        .number-card.positive {
            color: #ffffff; /* White text for positive numbers */
        }
        .info {
            text-align: center;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>NUMBER GO BIG</h1>
    <div class="info">
        <div>Round: <span id="round">1</span> / 10</div>
        <div>Score to win: 300</div>
    </div>
    
    <div class="info">
        <div id="operation">Next operation: 10 + ?</div>
        <div id="selected">Choose a number from your hand:</div>
    </div>
    
    <div class="hand" id="hand">
        <!-- Numbers will be generated here -->
    </div>
    
    <div class="controls">
        <button id="combineBtn" class="combine-btn">Combine</button>
        <button id="playBtn">Play</button>
    </div>
    
    <div id="gameOver" style="display: none; text-align: center; margin-top: 50px;">
        <h2>Game Over!</h2>
        <div>Final Score: <span id="finalScore">0</span></div>
        <div id="result"></div>
        <button onclick="restartGame()">Restart</button>
    </div>
    
    <div style="text-align: center; margin-top: 30px; color: #666; font-size: 14px;">
        Created by Alex Lorenzo
    </div>

    <script>
        // Game state
        let gameState = {
            round: 1,
            maxRounds: 10,
            availableNumbers: [1, 2, 3, 4, 5],
            currentResult: 10,
            currentOperator: '+',
            selectedNumber: null,
            gamePhase: 'playing',
            targetScore: 300,
            dualMode: false,
            secondOperator: '',
            selectedNumbers: [],
            selectedForCombination: [],
            combinationUsed: false
        };

        function getNumberRarity(number) {
            const absNumber = Math.abs(number);
            if (absNumber <= 3) return 'common';
            if (absNumber <= 6) return 'uncommon';
            if (absNumber <= 8) return 'rare';
            return 'legendary';
        }

        function generateRandomOperator() {
            const operators = ['+', '-', '*', '/'];
            return operators[Math.floor(Math.random() * operators.length)];
        }

        function generateRandomNumber() {
            let rand = Math.random() * 100;
            let number;
            
            if (rand <= 60) {
                number = Math.floor(Math.random() * 3) + 1;
            } else if (rand <= 85) {
                number = Math.floor(Math.random() * 3) + 4;
            } else if (rand <= 97) {
                number = Math.floor(Math.random() * 2) + 7;
            } else {
                number = 9;
            }
            
            if (Math.random() < 0.5) {
                number = -number;
            }
            
            return number;
        }

        function calculateResult(left, operator, right) {
            let result;
            switch(operator) {
                case '+': result = left + right; break;
                case '-': result = left - right; break;
                case '*': result = left * right; break;
                case '/': 
                    if (right === 0) return 0;
                    result = left / right; 
                    break;
            }
            return Math.ceil(result);
        }

        function updateDisplay() {
            // Cap the round display at 10
            const displayRound = Math.min(gameState.round, gameState.maxRounds);
            document.getElementById('round').textContent = displayRound;
            
            if (gameState.gamePhase === 'game_over') {
                document.getElementById('gameOver').style.display = 'block';
                document.getElementById('finalScore').textContent = Math.ceil(gameState.currentResult);
                if (gameState.currentResult >= gameState.targetScore) {
                    document.getElementById('result').textContent = 'Congratulations! You reached the target!';
                } else {
                    document.getElementById('result').textContent = `You need ${Math.ceil(gameState.targetScore - gameState.currentResult)} more points to win!`;
                }
                return;
            }

            // Always show both buttons
            const playBtn = document.getElementById('playBtn');
            const combineBtn = document.getElementById('combineBtn');

            // Play button logic
            if (gameState.dualMode) {
                // In dual mode: enabled when exactly 2 numbers selected
                if (gameState.selectedNumbers.length === 2) {
                    playBtn.disabled = false;
                    playBtn.classList.remove('disabled');
                } else {
                    playBtn.disabled = true;
                    playBtn.classList.add('disabled');
                }
                // Combine button disabled in dual mode
                combineBtn.disabled = true;
                combineBtn.classList.remove('enabled');
            } else {
                // Normal mode: enabled when exactly 1 number selected for play
                if (gameState.selectedNumber !== null && gameState.selectedForCombination.length === 0) {
                    playBtn.disabled = false;
                    playBtn.classList.remove('disabled');
                } else {
                    playBtn.disabled = true;
                    playBtn.classList.add('disabled');
                }

                // Combine button logic - enabled when exactly 2 numbers selected for combination
                if (!gameState.combinationUsed && gameState.selectedForCombination.length === 2) {
                    combineBtn.disabled = false;
                    combineBtn.classList.add('enabled');
                } else {
                    combineBtn.disabled = true;
                    combineBtn.classList.remove('enabled');
                }
            }

            // Update operation text
            if (gameState.dualMode) {
                let operationText = `Dual Operations (Round 5): ${gameState.currentResult} ${gameState.currentOperator} ? ${gameState.secondOperator} ?`;
                
                // Replace question marks with selected numbers
                if (gameState.selectedNumbers.length >= 1) {
                    const firstNumber = gameState.availableNumbers[gameState.selectedNumbers[0]];
                    operationText = operationText.replace('?', firstNumber);
                }
                if (gameState.selectedNumbers.length >= 2) {
                    const secondNumber = gameState.availableNumbers[gameState.selectedNumbers[1]];
                    operationText = operationText.replace('?', secondNumber);
                }
                
                document.getElementById('operation').textContent = operationText;
            } else {
                document.getElementById('operation').textContent = `Next operation: ${gameState.currentResult} ${gameState.currentOperator} ?`;
            }

            // Update selected text
            if (gameState.dualMode) {
                if (gameState.selectedNumbers.length > 0) {
                    const selectedValues = gameState.selectedNumbers.map(i => gameState.availableNumbers[i]);
                    document.getElementById('selected').textContent = `Selected for dual operations: ${selectedValues.join(', ')} (${gameState.selectedNumbers.length}/2)`;
                } else {
                    document.getElementById('selected').textContent = 'Choose two numbers for dual operations:';
                }
            } else if (gameState.selectedForCombination.length > 0) {
                document.getElementById('selected').textContent = `Selected for combination: ${gameState.selectedForCombination.length}/2 cards`;
            } else if (gameState.selectedNumber !== null) {
                document.getElementById('selected').textContent = `Selected: ${gameState.availableNumbers[gameState.selectedNumber]}`;
            } else {
                document.getElementById('selected').textContent = gameState.combinationUsed ? 
                    'Choose a number from your hand (Combination used this round):' : 
                    'Choose a number from your hand:';
            }
        }

        function renderHand() {
            const hand = document.getElementById('hand');
            hand.innerHTML = '';
            
            gameState.availableNumbers.forEach((number, index) => {
                const card = document.createElement('div');
                card.className = 'number-card';
                card.textContent = number;
                card.dataset.index = index; // Add unique index to each card
                
                // Add rarity class
                const rarity = getNumberRarity(number);
                card.classList.add(rarity);
                
                // Add positive/negative class
                if (number < 0) {
                    card.classList.add('negative');
                } else {
                    card.classList.add('positive');
                }
                
                // Check if selected
                let isSelected = false;
                if (gameState.dualMode) {
                    isSelected = gameState.selectedNumbers.includes(index);
                } else if (gameState.selectedForCombination.includes(index)) {
                    isSelected = true;
                } else if (gameState.selectedNumber === index && gameState.selectedForCombination.length === 0) {
                    isSelected = true;
                }

                if (isSelected) {
                    card.classList.add('selected');
                }
                
                card.onclick = () => selectNumber(index);
                hand.appendChild(card);
            });
        }

        function selectNumber(index) {
            if (gameState.dualMode) {
                // Dual mode: select up to 2 numbers for dual operations
                const selectedIndex = gameState.selectedNumbers.indexOf(index);
                if (selectedIndex > -1) {
                    // Deselect the number
                    gameState.selectedNumbers.splice(selectedIndex, 1);
                } else if (gameState.selectedNumbers.length < 2) {
                    // Add to dual selection
                    gameState.selectedNumbers.push(index);
                }
                // Clear other selections in dual mode
                gameState.selectedNumber = null;
                gameState.selectedForCombination = [];
            } else {
                // Normal mode: check if this number is already selected
                const isInPlaySelection = gameState.selectedNumber === index;
                const isInCombinationSelection = gameState.selectedForCombination.includes(index);
                
                if (isInPlaySelection) {
                    // Deselect from play
                    gameState.selectedNumber = null;
                } else if (isInCombinationSelection) {
                    // Deselect from combination
                    const selectedIndex = gameState.selectedForCombination.indexOf(index);
                    gameState.selectedForCombination.splice(selectedIndex, 1);
                } else {
                    // Add to selection
                    if (gameState.selectedForCombination.length > 0) {
                        // Already in combination mode, add to combination
                        if (gameState.selectedForCombination.length < 2) {
                            gameState.selectedForCombination.push(index);
                        }
                    } else if (gameState.selectedNumber !== null) {
                        // Already have one selected, start combination mode
                        gameState.selectedForCombination = [gameState.selectedNumber, index];
                        gameState.selectedNumber = null;
                    } else {
                        // Start with single selection
                        gameState.selectedNumber = index;
                    }
                }
            }
            updateDisplay();
            renderHand();
        }

        function playTurn() {
            if (gameState.dualMode) {
                const firstResult = calculateResult(gameState.currentResult, gameState.currentOperator, gameState.availableNumbers[gameState.selectedNumbers[0]]);
                const finalResult = calculateResult(firstResult, gameState.secondOperator, gameState.availableNumbers[gameState.selectedNumbers[1]]);
                gameState.currentResult = finalResult;
                
                // Remove selected numbers by index (in reverse order to maintain indices)
                gameState.selectedNumbers.sort((a, b) => b - a).forEach(index => {
                    gameState.availableNumbers.splice(index, 1);
                });
                gameState.selectedNumbers = [];
            } else {
                const result = calculateResult(gameState.currentResult, gameState.currentOperator, gameState.availableNumbers[gameState.selectedNumber]);
                gameState.currentResult = result;
                
                // Remove selected number by index
                gameState.availableNumbers.splice(gameState.selectedNumber, 1);
                gameState.selectedNumber = null;
            }
            
            // Add new number
            gameState.availableNumbers.push(generateRandomNumber());
            nextRound();
        }

        function nextRound() {
            gameState.round++;
            gameState.combinationUsed = false;
            
            if (gameState.round > gameState.maxRounds) {
                gameState.gamePhase = 'game_over';
            } else {
                if (gameState.round === 5) {
                    gameState.dualMode = true;
                    gameState.currentOperator = generateRandomOperator();
                    gameState.secondOperator = generateRandomOperator();
                } else {
                    gameState.dualMode = false;
                    gameState.currentOperator = generateRandomOperator();
                }
            }
            updateDisplay();
            renderHand();
        }

        function executeCombination() {
            if (gameState.selectedForCombination.length === 2) {
                const result = gameState.availableNumbers[gameState.selectedForCombination[0]] + gameState.availableNumbers[gameState.selectedForCombination[1]];
                
                // Remove selected numbers by index (in reverse order to maintain indices)
                gameState.selectedForCombination.sort((a, b) => b - a).forEach(index => {
                    gameState.availableNumbers.splice(index, 1);
                });
                
                // Add combination result
                gameState.availableNumbers.push(result);
                gameState.combinationUsed = true;
                gameState.combinationMode = false;
                gameState.selectedForCombination = [];
            }
            updateDisplay();
            renderHand();
        }

        function restartGame() {
            gameState = {
                round: 1,
                maxRounds: 10,
                availableNumbers: [1, 2, 3, 4, 5],
                currentResult: 10,
                currentOperator: generateRandomOperator(),
                selectedNumber: null,
                gamePhase: 'playing',
                targetScore: 300,
                dualMode: false,
                secondOperator: '',
                selectedNumbers: [],
                selectedForCombination: [],
                combinationUsed: false
            };
            document.getElementById('gameOver').style.display = 'none';
            updateDisplay();
            renderHand();
        }

        // Event listeners
        document.getElementById('playBtn').onclick = playTurn;
        document.getElementById('combineBtn').onclick = () => {
            // Only execute if 2 numbers are selected
            if (gameState.selectedForCombination.length === 2) {
                executeCombination();
            }
        };

        // Initialize game
        gameState.currentOperator = generateRandomOperator();
        updateDisplay();
        renderHand();
    </script>
</body>
</html>
