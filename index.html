<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUMBER GO BIG</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #222;
            color: white;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            border: 2px solid #444;
            background: #111;
        }
        .controls {
            margin-top: 20px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        button {
            padding: 12px 24px;
            margin: 6px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            min-width: 100px;
        }
        
        @media (max-width: 768px) {
            button {
                padding: 15px 30px;
                font-size: 16px;
                min-width: 120px;
            }
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        .combine-btn {
            background: #2196F3 !important;
        }
        .combine-btn.active {
            background: #4CAF50 !important;
        }
        button.disabled {
            background: #666 !important;
            cursor: not-allowed;
        }
        button.combine-btn {
            background: #666 !important;
        }
        button.combine-btn.enabled {
            background: #4CAF50 !important;
        }
        .hand {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        .number-card {
            width: 55px;
            height: 40px;
            background: #333;
            border: 3px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
        }
        
        @media (max-width: 768px) {
            .number-card {
                width: 45px;
                height: 35px;
                font-size: 14px;
            }
        }
        .number-card.selected {
            background: #4CAF50;
            border-color: #45a049 !important;
        }
        .number-card.common {
            border-color: #888; /* Grey for 1-3 */
        }
        .number-card.uncommon {
            border-color: #2196F3; /* Blue for 4-6 */
        }
        .number-card.rare {
            border-color: #9C27B0; /* Purple for 7-8 */
        }
        .number-card.legendary {
            border-color: #FF9800; /* Orange for 9 */
        }
        .number-card.negative {
            color: #ff4444; /* Red text for negative numbers */
        }
        .number-card.positive {
            color: #ffffff; /* White text for positive numbers */
        }
        .info {
            text-align: center;
            margin: 10px 0;
        }
        
        /* Operation display styles */
        .operation-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .fixed-card {
            width: 80px;
            height: 60px;
            background: #555;
            border: 3px solid #777;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-weight: bold;
            font-size: 24px;
            color: white;
            cursor: default;
        }
        
        .operator-display {
            font-size: 32px;
            font-weight: bold;
            color: #4CAF50;
            min-width: 40px;
            text-align: center;
        }
        
        .placeholder-card {
            width: 80px;
            height: 60px;
            background: rgba(33, 150, 243, 0.1);
            border: 3px dashed #2196F3;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            color: #666;
            font-size: 18px;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .placeholder-card.drag-over {
            border-color: #1976D2;
            background: rgba(33, 150, 243, 0.2);
            transform: scale(1.05);
        }
        
        .placeholder-card.highlight {
            animation: pulse 1s infinite;
        }
        
        .placeholder-card .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: #ff4444;
            border: 2px solid white;
            border-radius: 50%;
            color: white;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            min-width: 20px;
            min-height: 20px;
        }
        
        /* Drag and drop styles */
        .combine-zone {
            width: 200px;
            height: 80px;
            border: 3px dashed #4CAF50;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            background: rgba(76, 175, 80, 0.1);
            transition: all 0.3s ease;
        }
        
        .combine-zone.drag-over {
            border-color: #45a049;
            background: rgba(76, 175, 80, 0.2);
            transform: scale(1.05);
        }
        
        .combine-zone.has-cards {
            border-color: #2196F3;
            background: rgba(33, 150, 243, 0.1);
        }
        
        .combine-zone.highlight {
            animation: pulse 1s infinite;
        }
        
        .combine-zone-text {
            color: #666;
            font-size: 14px;
            text-align: center;
        }
        
        .combine-zone-text.has-cards {
            color: #2196F3;
        }
        
        .number-card.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }
        
        .number-card.draggable {
            cursor: grab;
        }
        
        .number-card.draggable:active {
            cursor: grabbing;
        }
        
        .number-card.touching {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        
        /* Pulse animation for drop zones */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .combine-card {
            width: 60px;
            height: 45px;
            background: #333;
            border: 2px solid #2196F3;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
            margin: 0 5px;
            position: relative;
        }
        
        .combine-card .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: #ff4444;
            border: 2px solid white;
            border-radius: 50%;
            color: white;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            min-width: 20px;
            min-height: 20px;
        }
        
        @media (max-width: 768px) {
            .fixed-card, .placeholder-card {
                width: 60px;
                height: 45px;
                font-size: 18px;
            }
            
            .operator-display {
                font-size: 24px;
            }
            
            .combine-zone {
                width: 160px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <h1>NUMBER GO BIG</h1>
    <div class="info">
        <div>Score 300 to win. Round <span id="round">1</span> / 10</div>
    </div>
    
    <div class="operation-display" id="operationDisplay">
        <div class="fixed-card" id="fixedCard">10</div>
        <div class="operator-display" id="operatorDisplay">+</div>
        <div class="placeholder-card" id="placeholderCard">?</div>
    </div>
    
    <div class="hand" id="hand">
        <!-- Numbers will be generated here -->
    </div>
    
    <div class="controls">
        <button id="playBtn">Play</button>
    </div>
    
    <div class="combine-zone" id="combineZone">
        <div class="combine-zone-text" id="combineZoneText">Drag 2 cards here to combine</div>
    </div>
    
    <div class="controls">
        <button id="combineBtn" class="combine-btn">Combine</button>
    </div>
    
    <div id="gameOver" style="display: none; text-align: center; margin-top: 50px;">
        <h2>Game Over!</h2>
        <div>Final Score: <span id="finalScore">0</span></div>
        <div id="result"></div>
        <button onclick="restartGame()">Restart</button>
    </div>
    
    <div style="text-align: center; margin-top: 30px; color: #666; font-size: 14px;">
        Created by Alex Lorenzo<br>
        v0.1
    </div>

    <script>
        // Game state
        let gameState = {
            round: 1,
            maxRounds: 10,
            availableNumbers: [1, 2, 3, 4, 5],
            currentResult: 10,
            currentOperator: '+',
            selectedNumber: null,
            gamePhase: 'playing',
            targetScore: 300,
            dualMode: false,
            secondOperator: '',
            selectedNumbers: [],
            selectedForCombination: [],
            combinationUsed: false,
            combineZoneCards: []
        };

        function getNumberRarity(number) {
            const absNumber = Math.abs(number);
            if (absNumber <= 3) return 'common';
            if (absNumber <= 6) return 'uncommon';
            if (absNumber <= 8) return 'rare';
            return 'legendary';
        }

        function generateRandomOperator() {
            const operators = ['+', '-', '*', '/'];
            return operators[Math.floor(Math.random() * operators.length)];
        }

        function generateRandomNumber() {
            let rand = Math.random() * 100;
            let number;
            
            if (rand <= 60) {
                number = Math.floor(Math.random() * 3) + 1;
            } else if (rand <= 85) {
                number = Math.floor(Math.random() * 3) + 4;
            } else if (rand <= 97) {
                number = Math.floor(Math.random() * 2) + 7;
            } else {
                number = 9;
            }
            
            if (Math.random() < 0.5) {
                number = -number;
            }
            
            return number;
        }

        function calculateResult(left, operator, right) {
            let result;
            switch(operator) {
                case '+': result = left + right; break;
                case '-': result = left - right; break;
                case '*': result = left * right; break;
                case '/': 
                    if (right === 0) return 0;
                    result = left / right; 
                    break;
            }
            return Math.ceil(result);
        }

        function updateDisplay() {
            // Cap the round display at 10
            const displayRound = Math.min(gameState.round, gameState.maxRounds);
            document.getElementById('round').textContent = displayRound;
            
            if (gameState.gamePhase === 'game_over') {
                document.getElementById('gameOver').style.display = 'block';
                document.getElementById('finalScore').textContent = Math.ceil(gameState.currentResult);
                if (gameState.currentResult >= gameState.targetScore) {
                    document.getElementById('result').textContent = 'Congratulations! You reached the target!';
                } else {
                    document.getElementById('result').textContent = `You need ${Math.ceil(gameState.targetScore - gameState.currentResult)} more points to win!`;
                }
                return;
            }

            // Update operation display
            updateOperationDisplay();
            
            // Update combine zone
            updateCombineZone();

            // Always show both buttons
            const playBtn = document.getElementById('playBtn');
            const combineBtn = document.getElementById('combineBtn');

            // Play button logic
            if (gameState.dualMode) {
                // In dual mode: enabled when exactly 2 numbers selected
                if (gameState.selectedNumbers.length === 2) {
                    playBtn.disabled = false;
                    playBtn.classList.remove('disabled');
                } else {
                    playBtn.disabled = true;
                    playBtn.classList.add('disabled');
                }
                // Combine button disabled in dual mode
                combineBtn.disabled = true;
                combineBtn.classList.remove('enabled');
            } else {
                // Normal mode: enabled when exactly 1 number selected for play
                if (gameState.selectedNumber !== null && gameState.selectedForCombination.length === 0) {
                    playBtn.disabled = false;
                    playBtn.classList.remove('disabled');
                } else {
                    playBtn.disabled = true;
                    playBtn.classList.add('disabled');
                }

                // Combine button logic - enabled when exactly 2 numbers in combine zone
                if (!gameState.combinationUsed && gameState.combineZoneCards.length === 2) {
                    combineBtn.disabled = false;
                    combineBtn.classList.add('enabled');
                } else {
                    combineBtn.disabled = true;
                    combineBtn.classList.remove('enabled');
                }
            }
        }
        
        function updateOperationDisplay() {
            const fixedCard = document.getElementById('fixedCard');
            const operatorDisplay = document.getElementById('operatorDisplay');
            const placeholderCard = document.getElementById('placeholderCard');
            
            // Update fixed card with current result
            fixedCard.textContent = Math.ceil(gameState.currentResult);
            
            // Convert operator symbols
            let operatorSymbol = gameState.currentOperator;
            if (operatorSymbol === '*') operatorSymbol = '×';
            if (operatorSymbol === '/') operatorSymbol = '÷';
            if (operatorSymbol === '-') operatorSymbol = '−';
            
            operatorDisplay.textContent = operatorSymbol;
            
            // Clear existing remove button
            const existingRemoveBtn = placeholderCard.querySelector('.remove-btn');
            if (existingRemoveBtn) {
                existingRemoveBtn.remove();
            }
            
            // Update placeholder based on selection
            if (gameState.dualMode) {
                if (gameState.selectedNumbers.length >= 1) {
                    const firstNumber = gameState.availableNumbers[gameState.selectedNumbers[0]];
                    placeholderCard.textContent = firstNumber;
                    placeholderCard.style.background = '#4CAF50';
                    placeholderCard.style.borderColor = '#45a049';
                } else {
                    placeholderCard.textContent = '?';
                    placeholderCard.style.background = '#333';
                    placeholderCard.style.borderColor = '#666';
                }
            } else {
                if (gameState.selectedNumber !== null) {
                    // selectedNumber is now the actual number value, not an index
                    placeholderCard.textContent = gameState.selectedNumber;
                    placeholderCard.style.background = '#333';
                    placeholderCard.style.borderColor = '#2196F3'; // Blue border like original cards
                    placeholderCard.style.color = '#ffffff'; // White text like original cards
                    placeholderCard.style.borderStyle = 'solid'; // Solid border instead of dashed
                    
                    // Add remove button
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-btn';
                    removeBtn.textContent = '×';
                    removeBtn.onclick = removeFromPlayZone;
                    placeholderCard.appendChild(removeBtn);
                } else {
                    placeholderCard.textContent = '?';
                    placeholderCard.style.background = '#333';
                    placeholderCard.style.borderColor = '#666';
                }
            }
            
            // Make placeholder card droppable
            placeholderCard.draggable = false;
            placeholderCard.addEventListener('dragover', handleDragOver);
            placeholderCard.addEventListener('dragleave', handleDragLeave);
            placeholderCard.addEventListener('drop', handlePlaceholderDrop);
        }
        
        function handlePlaceholderDrop(e) {
            e.preventDefault();
            e.target.classList.remove('drag-over');
            
            const index = parseInt(e.dataTransfer.getData('text/plain'));
            const number = gameState.availableNumbers[index];
            
            // Remove from hand first
            gameState.availableNumbers.splice(index, 1);
            
            // Select the number for play
            if (gameState.dualMode) {
                // Adjust indices for remaining cards in dual mode
                gameState.selectedNumbers = gameState.selectedNumbers.map(selectedIndex => {
                    if (selectedIndex > index) {
                        return selectedIndex - 1;
                    }
                    return selectedIndex;
                });
                
                if (!gameState.selectedNumbers.includes(index) && gameState.selectedNumbers.length < 2) {
                    gameState.selectedNumbers.push(index);
                }
            } else {
                // For normal mode, we need to track the selected number differently
                // since we removed it from availableNumbers
                gameState.selectedNumber = number; // Store the actual number instead of index
            }
            
            updateDisplay();
            renderHand();
        }
        
        function updateCombineZone() {
            const combineZone = document.getElementById('combineZone');
            const combineZoneText = document.getElementById('combineZoneText');
            
            // Clear existing cards
            const existingCards = combineZone.querySelectorAll('.combine-card');
            existingCards.forEach(card => card.remove());
            
            if (gameState.combineZoneCards.length === 0) {
                combineZoneText.style.display = 'block';
                combineZoneText.textContent = 'Drag 2 cards here to combine';
                combineZone.classList.remove('has-cards');
            } else {
                combineZoneText.style.display = 'none';
                combineZone.classList.add('has-cards');
                
                // Add cards to combine zone
                gameState.combineZoneCards.forEach((cardData, index) => {
                    const card = document.createElement('div');
                    card.className = 'combine-card';
                    card.textContent = cardData.number;
                    card.dataset.index = index;
                    
                    // Add rarity styling
                    const rarity = getNumberRarity(cardData.number);
                    card.classList.add(rarity);
                    
                    if (cardData.number < 0) {
                        card.classList.add('negative');
                    } else {
                        card.classList.add('positive');
                    }
                    
                    // Add remove button
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-btn';
                    removeBtn.textContent = '×';
                    removeBtn.onclick = () => removeFromCombineZone(index);
                    card.appendChild(removeBtn);
                    
                    combineZone.appendChild(card);
                });
            }
        }

        function renderHand() {
            const hand = document.getElementById('hand');
            hand.innerHTML = '';
            
            gameState.availableNumbers.forEach((number, index) => {
                const card = document.createElement('div');
                card.className = 'number-card draggable';
                card.textContent = number;
                card.dataset.index = index;
                card.draggable = true;
                
                // Add rarity class
                const rarity = getNumberRarity(number);
                card.classList.add(rarity);
                
                // Add positive/negative class
                if (number < 0) {
                    card.classList.add('negative');
                } else {
                    card.classList.add('positive');
                }
                
                // Check if selected (only for dual mode and combination mode)
                let isSelected = false;
                if (gameState.dualMode) {
                    isSelected = gameState.selectedNumbers.includes(index);
                } else if (gameState.selectedForCombination.includes(index)) {
                    isSelected = true;
                }
                // Note: Removed green highlighting for normal play selection

                if (isSelected) {
                    card.classList.add('selected');
                }
                
                // Add drag and drop event listeners
                card.addEventListener('dragstart', handleDragStart);
                card.addEventListener('dragend', handleDragEnd);
                card.addEventListener('click', () => selectNumber(index));
                
                // Add touch event listeners for mobile
                card.addEventListener('touchstart', handleTouchStart);
                card.addEventListener('touchend', handleTouchEnd);
                
                hand.appendChild(card);
            });
        }

        function selectNumber(index) {
            if (gameState.dualMode) {
                // Dual mode: select up to 2 numbers for dual operations
                const selectedIndex = gameState.selectedNumbers.indexOf(index);
                if (selectedIndex > -1) {
                    // Deselect the number
                    gameState.selectedNumbers.splice(selectedIndex, 1);
                } else if (gameState.selectedNumbers.length < 2) {
                    // Add to dual selection
                    gameState.selectedNumbers.push(index);
                }
                // Clear other selections in dual mode
                gameState.selectedNumber = null;
                gameState.selectedForCombination = [];
            } else {
                // Normal mode: select for play
                if (gameState.selectedNumber === index) {
                    // Deselect
                    gameState.selectedNumber = null;
                } else {
                    // Select for play
                    gameState.selectedNumber = index;
                }
            }
            updateDisplay();
            renderHand();
        }
        
        // Drag and drop handlers
        function handleDragStart(e) {
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.target.outerHTML);
            e.dataTransfer.setData('text/plain', e.target.dataset.index);
        }
        
        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            e.target.classList.add('drag-over');
        }
        
        function handleDragLeave(e) {
            e.target.classList.remove('drag-over');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            e.target.classList.remove('drag-over');
            
            const index = parseInt(e.dataTransfer.getData('text/plain'));
            const number = gameState.availableNumbers[index];
            
            // Check if card is already in combine zone by comparing the actual number
            const alreadyInZone = gameState.combineZoneCards.some(card => card.number === number);
            if (alreadyInZone) return;
            
            // Add to combine zone if not full
            if (gameState.combineZoneCards.length < 2) {
                gameState.combineZoneCards.push({
                    number: number,
                    originalIndex: index
                });
                
                // Remove from hand
                gameState.availableNumbers.splice(index, 1);
                
                // Adjust indices for remaining cards in combine zone
                gameState.combineZoneCards.forEach(card => {
                    if (card.originalIndex > index) {
                        card.originalIndex--;
                    }
                });
                
                updateDisplay();
                renderHand();
            }
        }
        
        function removeFromCombineZone(index) {
            const cardToReturn = gameState.combineZoneCards[index];
            // Return the card to the hand
            gameState.availableNumbers.push(cardToReturn.number);
            // Remove from combine zone
            gameState.combineZoneCards.splice(index, 1);
            updateDisplay();
            renderHand();
        }
        
        function removeFromPlayZone() {
            if (gameState.selectedNumber !== null) {
                // Return the card to the hand
                gameState.availableNumbers.push(gameState.selectedNumber);
                // Clear selection
                gameState.selectedNumber = null;
                updateDisplay();
                renderHand();
            }
        }
        
        // Touch event handlers for mobile
        function handleTouchStart(e) {
            e.preventDefault();
            e.target.classList.add('touching');
        }
        
        function handleTouchEnd(e) {
            e.preventDefault();
            e.target.classList.remove('touching');
            
            // Check if touching a drop zone
            const touch = e.changedTouches[0];
            const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
            
            if (elementBelow && elementBelow.closest('.combine-zone')) {
                // Add to combine zone
                const index = parseInt(e.target.dataset.index);
                handleCombineZoneTouch(index);
            } else if (elementBelow && elementBelow.closest('.placeholder-card')) {
                // Add to play zone
                const index = parseInt(e.target.dataset.index);
                handlePlayZoneTouch(index);
            }
        }
        
        function handleCombineZoneTouch(index) {
            const number = gameState.availableNumbers[index];
            
            // Check if card is already in combine zone by comparing the actual number
            const alreadyInZone = gameState.combineZoneCards.some(card => card.number === number);
            if (alreadyInZone) return;
            
            // Add to combine zone if not full
            if (gameState.combineZoneCards.length < 2) {
                gameState.combineZoneCards.push({
                    number: number,
                    originalIndex: index
                });
                
                // Remove from hand
                gameState.availableNumbers.splice(index, 1);
                
                // Adjust indices for remaining cards in combine zone
                gameState.combineZoneCards.forEach(card => {
                    if (card.originalIndex > index) {
                        card.originalIndex--;
                    }
                });
                
                updateDisplay();
                renderHand();
            }
        }
        
        function handlePlayZoneTouch(index) {
            const number = gameState.availableNumbers[index];
            
            if (gameState.selectedNumber === null) {
                // Remove from hand first
                gameState.availableNumbers.splice(index, 1);
                
                // Select the number for play
                gameState.selectedNumber = number;
                
                updateDisplay();
                renderHand();
            }
        }

        function playTurn() {
            if (gameState.dualMode) {
                const firstResult = calculateResult(gameState.currentResult, gameState.currentOperator, gameState.availableNumbers[gameState.selectedNumbers[0]]);
                const finalResult = calculateResult(firstResult, gameState.secondOperator, gameState.availableNumbers[gameState.selectedNumbers[1]]);
                gameState.currentResult = finalResult;
                
                // Remove selected numbers by index (in reverse order to maintain indices)
                gameState.selectedNumbers.sort((a, b) => b - a).forEach(index => {
                    gameState.availableNumbers.splice(index, 1);
                });
                gameState.selectedNumbers = [];
            } else {
                const result = calculateResult(gameState.currentResult, gameState.currentOperator, gameState.selectedNumber);
                gameState.currentResult = result;
                
                // selectedNumber is already removed from availableNumbers when dragged
                gameState.selectedNumber = null;
            }
            
            // Add new number
            gameState.availableNumbers.push(generateRandomNumber());
            nextRound();
        }

        function nextRound() {
            gameState.round++;
            gameState.combinationUsed = false;
            
            if (gameState.round > gameState.maxRounds) {
                gameState.gamePhase = 'game_over';
            } else {
                if (gameState.round === 5) {
                    gameState.dualMode = true;
                    gameState.currentOperator = generateRandomOperator();
                    gameState.secondOperator = generateRandomOperator();
                } else {
                    gameState.dualMode = false;
                    gameState.currentOperator = generateRandomOperator();
                }
            }
            updateDisplay();
            renderHand();
        }

        function executeCombination() {
            if (gameState.combineZoneCards.length === 2) {
                const result = gameState.combineZoneCards[0].number + gameState.combineZoneCards[1].number;
                
                // Add combination result (cards already removed from hand when dragged)
                gameState.availableNumbers.push(result);
                gameState.combinationUsed = true;
                gameState.combineZoneCards = [];
            }
            updateDisplay();
            renderHand();
        }

        function restartGame() {
            gameState = {
                round: 1,
                maxRounds: 10,
                availableNumbers: [1, 2, 3, 4, 5],
                currentResult: 10,
                currentOperator: generateRandomOperator(),
                selectedNumber: null,
                gamePhase: 'playing',
                targetScore: 300,
                dualMode: false,
                secondOperator: '',
                selectedNumbers: [],
                selectedForCombination: [],
                combinationUsed: false,
                combineZoneCards: []
            };
            document.getElementById('gameOver').style.display = 'none';
            updateDisplay();
            renderHand();
        }

        // Event listeners
        document.getElementById('playBtn').onclick = playTurn;
        document.getElementById('combineBtn').onclick = () => {
            // Only execute if 2 numbers are in combine zone
            if (gameState.combineZoneCards.length === 2) {
                executeCombination();
            }
        };
        
        // Set up combine zone drag and drop
        const combineZone = document.getElementById('combineZone');
        combineZone.addEventListener('dragover', handleDragOver);
        combineZone.addEventListener('dragleave', handleDragLeave);
        combineZone.addEventListener('drop', handleDrop);
        
        // Add touch event listeners to drop zones
        combineZone.addEventListener('touchstart', (e) => {
            e.preventDefault();
            combineZone.classList.add('highlight');
        });
        
        combineZone.addEventListener('touchend', (e) => {
            e.preventDefault();
            combineZone.classList.remove('highlight');
        });
        
        // Add touch support for placeholder card
        const placeholderCard = document.getElementById('placeholderCard');
        placeholderCard.addEventListener('touchstart', (e) => {
            e.preventDefault();
            placeholderCard.classList.add('highlight');
        });
        
        placeholderCard.addEventListener('touchend', (e) => {
            e.preventDefault();
            placeholderCard.classList.remove('highlight');
        });

        // Initialize game
        gameState.currentOperator = generateRandomOperator();
        updateDisplay();
        renderHand();
    </script>
</body>
</html>
